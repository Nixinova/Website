<!DOCTYPE html>
<html lang="en-NZ">
<head>
    <title>Subpage Index</title>
    <meta charset="UTF-8">
    <meta name="description" content="View subpages">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/assets/css/main.css">
</head>

<body>

    <script data-name="Page script">

        var query = location.href.split('?')[1];
        if (!query) query = "default";
        var data = {
            "downloads": {
                subfolders: ["minecraft"],
                subpages: []
            },
            "downloads/minecraft": {
                subfolders: ["maps", "resource-packs"],
                subpages: []
            },
            "downloads/minecraft/maps": {
                subfolders: [],
                subpages: ["kitpvp", "musical-blocks", "skywars"]
            },
            "downloads/minecraft/resource-packs": {
                subfolders: [],
                subpages: ["mash-up", "herobrinenzk", "themed"]
            },
            "tools": {
                subfolders: ["minecraft","hytale"],
                subpages: []
            },
            "tools/minecraft": {
                subfolders: ["api", "converters","commands"],
                subpages: []
            },
            "tools/minecraft/api": {
                subfolders: [],
                subpages: ["player"]
            },
            "tools/minecraft/converters": {
                subfolders: [],
                subpages: ["coordinates"]
            },
            "tools/minecraft/commands": {
                subfolders: [],
                subpages: ["give", "summon"]
            },
            "tools/hytale": {
                subfolders: ["api"],
                subpages: []
            },
            "tools/hytale/api": {
                subfolders: [],
                subpages: ["blog"]
            },
            "default": {
                subfolders: ["downloads", "tools"],
                subpages: ["404", "index", "search", "view"]
            }
        }
        if (data[query] === undefined) query = 'default';
        
        $(function() {

            $('#subfolders-text').empty();
            $('#subpages-text').empty();

            if (location.href.split('/')[3] !== 'subpages?') {
                if (location.href.split('/')[3] && location.href.split('/')[4] === undefined) {
                    $('#go-up').append(`\n<a href="/subpages?">← Go back</a>`);
                } else {
                    $('#go-up').append(`\n<a href="${location.href.replace(/(.+)\/[a-z]+$/, '$1')}">← Go back</a>`);
                }
            } 

            if (data[query].subfolders.length > 0) {
                let folder = query === 'default' ? '' : '/'+query;
                $('#subfolders-title').removeClass('hide');
                for (let subfolder of data[query].subfolders) {
                    $('#subfolders-text').append(`\n<li><strong><a href="${folder}/${subfolder}/">/${subfolder}</a></strong></li>`)
                }
            }

            if (data[query].subpages.length > 0) {
                let folder = query === 'default' ? '' : '/'+query;
                $('#subpages-title').removeClass('hide');
                for (let subpage of data[query].subpages) {
                    $('#subpages-text').append(`\n<li><a href="${folder}/${subpage}">${subpage}</a></li>`)
                }
            }

        });
        

   </script>
    
    <header>
        <nav></nav>
        <script id="load-nav">$('nav').load('/imports/navigation'); $('#load-nav').remove();</script>
    </header>

    <main style="display: flex;">
        <div id="content" style="margin: auto;">

            <h1 style="border-bottom: solid;">Subpage index</h1>
            <span id="go-up"></span>
            <br/>

            <h2 id="subfolders-title" class="hide">Subfolders</h2>
            <ul id="subfolders-text"></ul>

            <h2 id="subpages-title" class="hide">Subpages</h2>
            <ul id="subpages-text"></ul>

        </div>
    </main>

    <footer style="margin-top: 0;"></footer>
    <script id="load-footer">$("footer").load("/imports/footer"); $('#load-footer').remove();</script>

</body>
</html>