<html lang="en-NZ">
<head>
    <title>Minecraft Player API &ndash; Nixinova</title>
    <meta charset="UTF-8">
    <meta name="description" content="Get information about Minecraft player.">
    <meta name="keywords" content="nixinova,minecraft,minecraft api,minecraft blog api,minecraft blog info,minecraft blog dates">
    <meta name="author" content="Nixinova">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/tools.css">
</head>
<body>
    <script>
        var usernames = [];
        function getInfo(username) {
            $('output p').html('Loading...');
            $.ajax({
                url: 'https://cors-anywhere.herokuapp.com/https://api.mojang.com/users/profiles/minecraft/' + username
            }).done(function(data) {
                if (data) {
                    let uuid = data.id;
                    $.ajax({
                        url: `https://cors-anywhere.herokuapp.com/https://api.mojang.com/user/profiles/${uuid}/names`
                    }).done(function(data) {
                        $('output p').empty();
                        for (i in data) {
                            let name = data[i].name;
                            let date = moment(data[i].changedToAt).format('D MMMM YYYY [at] HH:mm:ss [UTC]');
                            if (i+1 == data.length) {
                            let uuidFormatted = [
                                uuid.substring(0,8),
                                uuid.substring(9,12), uuid.substring(13,16), uuid.substring(17,20),
                                uuid.substring(21,32)
                            ].join('-');
                                $('output p').html(`<strong>${name} (UUID ${uuidFormatted})</strong>`);
                                $('output ul').append(`<li> Name #${parseInt(i)+1} (current): ${name} (changed on ${date}) </li>`);
                            } else if (i == 0) {
                                $('output ul').append(`<li> Name #1: ${name} </li>`);
                            } else {
                                $('output ul').append(`<li> Name #${parseInt(i)+1}: ${name} (changed on ${date}) </li>`);
                            }
                        }
                    });
                } else {
                    $('output ul').append("Could not find player " + username);
                }
            });
        }
    </script>
    <header>
        <nav></nav>
        <script id="load-nav">$("nav").load("/assets/imports/navigation"); $('#load-nav').remove();</script>
    </header>

    <main class="content">
        <h1>Minecraft Player API</h1>
        <p style="text-align: center;">Get information about any Minecraft player.</p>
        <div>
            <p style="text-align: center;">
                <label>Username:</label>
                <input type="text" id="input-username"> &nbsp;
                <button id="get-info" onclick="getInfo($('#input-username').val());">Get info</button><br>
            </p>
        </div>
        <output style="margin: 1em; display: block;">
            <p></p>
            <ul></ul>
        </output>
    </main>

    <footer>
        <span id="copyright"></span>
    </footer>
    <script id="load-copyright">$("#copyright").load("/assets/imports/footer"); $("#load-copyright").remove();</script>
</body>
</html>
