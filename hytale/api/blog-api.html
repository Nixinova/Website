<html lang="en-NZ">
<head>
    <title>Hytale Blog API &ndash; Nixinova</title>
    <meta charset="UTF-8">
    <meta name="description" content="Get information about any Hytale blog post. Automatically updates for any new blog posts released.">
    <meta name="keywords" content="nixinova,hytale,hytale api,hytale blog api,hytale blog info,hytale blog dates">
    <meta name="author" content="Nixinova">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/tools.css">
</head>
<body>
    <script>
        var blog = {titles: [], urls: [], dates: [], excerpts: [], authors: [], images: []};
        $.ajax({
            url: 'https://hytale.com/api/blog/post/published',
            dataType: 'jsonp'
        }).done(function(data) {
            let blogs = data;
            for (i in blogs) {
                blog.titles.push(blogs[i].title);
                blog.urls.push(blogs[i].slug);
                blog.dates.push(blogs[i].publishedAt);
                blog.excerpts.push(blogs[i].bodyExcerpt);
                blog.authors.push(blogs[i].author);
                blog.images.push(blogs[i].coverImage.s3Key);
                $('#titles').append(`<option value="${blog.urls[i]}">${blog.titles[i]}</option>`);
            }
        });

        function getInfo() {
            let selected_blog = $('#titles').val();
            let index = blog.urls.indexOf(selected_blog);

            const months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
            const weekdays = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];

            let date = moment(blog.dates[index]);
            let image = 'https://cdn.hytale.com/variants/blog_cover_' + blog.images[index];
            let url = `https://hytale.com/news/${date.year()}/${date.month()}/${selected_blog}`;
            let title = blog.titles[index];
            let author = blog.authors[index];
            let excerpt = blog.excerpts[index];

            $('output').html(`
                <img src="${image}">
                <h3>${title}</h3>
                <em>
                    Posted on <time datetime="${blog.dates[index]}">${date.format('LL [at] LTS zz')}</time>
                    by ${author}
                </em>
                <p style="line-height: 1.8;">
                    ${excerpt}
                    <a href="${url}">(read more)</a>
                </p>
            `);
        }
    </script>
    <header>
        <nav></nav>
        <script id="load-nav">$("nav").load("/assets/imports/navigation"); $('#load-nav').remove();</script>
    </header>

    <main>
        <form action="javascript:submit()" id="input_form">
            <h1>Hytale Blog API</h1>
            <p style="text-align: center;">Get information about any Hytale blog post.</p>
            <div>
                <p style="text-align: center;">
                    <label>Blog post:</label>
                    <select id="titles" style="width: auto; max-width: 60%;"></select> &nbsp;
                    <button onclick="getInfo()">Get info</button><br>
                </p>
            </div>
            <output style="margin: 1em; display: block;"></output>
        </form>
    </main>

    <footer>
        <span id="copyright"></span>
    </footer>
    <script id="load-copyright">$("#copyright").load("/assets/imports/footer"); $("#load-copyright").remove();</script>
</body>
</html>
